<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: program.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: program.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @author indmind &lt;mail.indmind@gmail.com>
 * @file proses compiling
 * @version 0.0.1
 */

const tokenizer = require("./tokenizer");
const parser = require("./parser");
const fs = require("fs");
const childProcess = require('child_process');

exports.compile = _filepath => {
    global.userFilePath = _filepath;
    const token = tokenizer.lex(_filepath);
    const parsed = parser.parse(token);
    return parsed;
};

exports.run = parsed => {
    const tempFile = "../temp/" + generateName();
    fs.writeFile(tempFile, parsed, (err) => {
        if(err) throw err;
        runScript(tempFile, code => {
            if(code) throw code;
            fs.unlink(tempFile, _err => {
                if(_err) throw _err;
            });
        });
    });
};

function runScript(_scriptPath, _callback){
    let invoked = false;
    let process = childProcess.fork(_scriptPath);

    process.on('exit', code => {
        if(invoked) return;
        invoked = true;
        let err = code == 0 ? null : new Error("exit code " + code);
        _callback(err);
    });
}

function generateName(_length = 10){
    let text = '';
    let possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890";
    for(let i = 0;i &lt; _length;i++) text += possible.charAt(Math.floor(Math.random() * possible.length));
    return text;
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Tokenizer.html">Tokenizer</a></li></ul><h3>Global</h3><ul><li><a href="global.html#action">action</a></li><li><a href="global.html#c">c</a></li><li><a href="global.html#filepath">filepath</a></li><li><a href="global.html#filter">filter</a></li><li><a href="global.html#line">line</a></li><li><a href="global.html#parameters">parameters</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Nov 28 2017 14:50:17 GMT+0700 (SE Asia Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
